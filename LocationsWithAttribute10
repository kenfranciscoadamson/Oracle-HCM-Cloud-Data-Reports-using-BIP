SELECT DISTINCT PLDF.ATTRIBUTE10 "Attribute10" --sample reference flexfield from the client
	, PL.INTERNAL_LOCATION_CODE "LocationCode"
	, FSS.SET_NAME "SetName"
	, FSS.SET_CODE "SetCode"
	, PLDFT.LOCATION_NAME "LocationName"
	, TO_CHAR(PLDF.EFFECTIVE_START_DATE, 'YYYY/MM/DD') "EffectiveStartDate"
	, TO_CHAR(PLDF.EFFECTIVE_END_DATE, 'YYYY/MM/DD') "EffectiveEndDate"
	, HIKM.SOURCE_SYSTEM_OWNER "SourceSystemOwner"
	, HIKM.SOURCE_SYSTEM_ID "SourceSystemId"
	, PL.CREATED_BY "CreatedBy"
	, TO_CHAR(PL.CREATION_DATE, 'YYYY/MM/DD') "CreationDate"
	, PL.LAST_UPDATED_BY "LastUpdatedBy"
	, TO_CHAR(PL.LAST_UPDATE_DATE, 'YYYY/MM/DD') "LastUpdateDate"
FROM PER_LOCATIONS PL
	, PER_LOCATION_DETAILS_F PLDF
	, PER_LOCATION_DETAILS_F_TL PLDFT
	, FND_SETID_SETS FSS
	, HRC_INTEGRATION_KEY_MAP HIKM
WHERE 1 = 1
	AND PL.LOCATION_ID = PLDF.LOCATION_ID
	AND PLDF.LOCATION_DETAILS_ID = PLDFT.LOCATION_DETAILS_ID
	AND PL.SET_ID = FSS.SET_ID
	AND FSS.LANGUAGE = FSS.SOURCE_LANG
	AND PLDFT.LANGUAGE = PLDFT.SOURCE_LANG
	AND PL.LOCATION_ID = HIKM.SURROGATE_ID
	AND HIKM.OBJECT_NAME = 'Location'
	AND INTERNAL_LOCATION_CODE = nvl(:LocationCode, PL.INTERNAL_LOCATION_CODE)
	AND SET_NAME = nvl(:SetName, FSS.SET_NAME)
	AND LOCATION_NAME LIKE nvl(:LocationName, PLDFT.LOCATION_NAME)
	AND DECODE(:SelectRecords, 'ALL', SYSDATE, PLDFT.EFFECTIVE_START_DATE) <= SYSDATE
	AND DECODE(:SelectRecords, 'ALL', SYSDATE, PLDFT.EFFECTIVE_END_DATE) >= SYSDATE
	AND DECODE(:SelectRecords, 'ALL', SYSDATE, PLDF.EFFECTIVE_START_DATE) <= SYSDATE
	AND DECODE(:SelectRecords, 'ALL', SYSDATE, PLDF.EFFECTIVE_END_DATE) >= SYSDATE
ORDER BY PL.INTERNAL_LOCATION_CODE, TO_CHAR(PLDF.EFFECTIVE_START_DATE, 'YYYY/MM/DD')
